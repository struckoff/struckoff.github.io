<!DOCTYPE html>
<html>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script> 
	
    <link href="calc.css" rel="stylesheet" type="text/css"/>
	<link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css" rel="stylesheet" type="text/css"/>
	<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>
    <!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <link href='http://fonts.googleapis.com/css?family=Press+Start+2P&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

<!-- Optional theme -->
<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">

<!-- Latest compiled and minified JavaScript -->
<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
  
 <head>
	<title>Calc</title>
	<meta charset="utf-8">
	
 </head>
 <body class="bgm">
   <select id="sel" class="form-control"><option>CHOOSE:</option></select> <qwe></qwe> <span id="args"></span>    
      <div class="bgm" id="r"></div>
      
 <script>           
   $.getJSON("quest.json",function(operations){
       function Calc(){
   //заполнение объекта-калькулятора операциями
           for (k in operations) {
                this[k] = new Function(operations[k][1]);
           }
         
           this.buildSelect = function(){
              for (k in operations) {
                $("select").append("<option value='" + k + "'>" + operations[k][2] + "</option>");  
              
              }             
           }

           this.buildInputs = function(){
           	 var args = operations[$("select").val()][0];
             $("#args").html("");
             $("qwe").html("ARGUMENTS:");
             
           	 for (var i = 0; i < args; i++)
                $("#args").append("<input>");            
                $( "<button>COMPUTE</button>" ).appendTo( "#args" ).on("click", function(){
             
                  var vals = $("input").map(function(){return $(this).val()}).get(); //получить массив аргументов
                  $("#r").html(       Calc()[  $("select").val()   ].apply(null, vals)    );
                  $("#AC").remove();
                  console.log(Calc()[  $("select").val()   ].apply(null, vals));
                  if  (Calc()[  $("select").val()   ].apply(null, vals) == 18){$("body").append("<div id='AC'>AliceCooper</div>")} 
                  $("#r").effect("pulsate",1000);
                  $("select")[0].selectedIndex = 0; 
             });
           }
           return this;
         }
         Calc().buildSelect();  
         $("select").on("change",  function(){  
           	  Calc().buildInputs();
         });  });
     
     	//]]>
   </script>
 </body>
</html>